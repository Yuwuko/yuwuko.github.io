<html>
<head>
    <title>Yuuko</title>
    <link rel="icon" href="https://avatars0.githubusercontent.com/u/46527589?s=400&u=734a3858c89ea458d4fa6f67ba803a3ce61b4938&v=4" type="image/png">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
    <link href="/a/css/m.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
</head>
<body class="d-flex h-100 text-center text-white bg-dark">

    <div class="cover-container d-flex w-100 h-100 p-3 mx-auto flex-column">
        <header class="mb-auto">
            <div>
                <nav class="nav nav-masthead justify-content-center float-md-end">
                    <a class="nav-link" href="https://github.com/Yuwuko/Yuuko">Source</a>
                </nav>
            </div>
        </header>

        <main class="px-3">
            <h1>Yuuko</h1>
            <p class="lead">Watching over <span id="guilds"></span> guilds, who have posted <span id="events"></span> messages in the past <span id="uptime"></span></p>
            <p class="lead">
                <a href="https://discord.com/oauth2/authorize?client_id=420682957007880223&permissions=8&scope=bot" class="btn btn-lg btn-secondary fw-bold border-white bg-white">Invite</a>
            </p>
        </main>

        <footer class="mt-auto text-white-50">
            <p>Made with ❤️ by <a href="https://github.com/BasketBandit" class="text-white">BasketBandit</a>.</p>
        </footer>
    </div>

    <script>
        $.getJSON('http://www.nooksworkbench.com:8080/api/guilds', function(data) {
            $("#guilds").html(commafy(data[0].guildCount));
        });
        $.getJSON('http://www.nooksworkbench.com:8080/api/events', function(data) {
            $("#events").html(commafy(data[0].messageEvents));
        });
        $.getJSON('http://www.nooksworkbench.com:8080/api/uptime', function(data) {
            $("#uptime").html(msToTime(data[0].uptime));
        });

        // Found on SO (shock), modified for my needs.
        function msToTime (ms) {
            var seconds = (ms/1000);
            var minutes = parseInt(seconds/60, 10);
            var hours = parseInt(minutes/60, 10);
            minutes = minutes%60;
            var days = parseInt(hours/24, 10);
            hours = hours%24;

            return days + " day" + (days>1?"s":"") + ", " + hours + " hour" + (hours>1?"s":"") + ", and " + minutes + " minute" + (minutes>1?"s":"") +".";
        }

        // https://stackoverflow.com/questions/2901102/how-to-print-a-number-with-commas-as-thousands-separators-in-javascript?page=2&tab=active#tab-top
        function commafy(num){
            var parts = (''+(num<0?-num:num)).split("."), s=parts[0], L, i=L= s.length, o='';
            while(i--){ o = (i===0?'':((L-i)%3?'':','))
                +s.charAt(i) +o }
            return (num<0?'-':'') + o + (parts[1] ? '.' + parts[1] : '');
        }
    </script>
</body>
</html>
